# 数据结构：树

平衡二叉树查询性能可以说是树中最优的了。但是偏偏好多时候不用它。

编程语言中用到的内置或作为库存在的dict结构（比如cpp的stl），往往用红黑树——一种特殊的二叉树；数据库中惯用B树。

红黑树：“确保没有一条路径会比其他路径长出俩倍”的一种二叉树；查询性能自然稍弱于平衡二叉树。但是有添加删除的时候，树维护相比二叉树所用的操作少（涉及的旋转少），所以维护性能更高。所以用红黑树。

至于B树呢？与计算机系统软硬件限制有关。B树索引一般是存在硬盘上的。操作系统从硬盘读数据的时候一次读一个基本数据单元（不可能只读一半）。所以基于硬盘索引的话，需要读硬盘次数越少越好。用二叉树的话，分叉太多节点太多，很可能需要读盘次数太多。而用B树的话，更扁平，层数更少，节点数也少，可以更少读盘。（虽然单个节点内需要二分或顺序扫）

B树和B+树的主要区别是B+树只有最底层叶子上才存有数据。所以数据库一般更惯用B+树——单次读来的数据块上可以存放更多的数据嘛。也因此，数据库的索引的key长度，尽量短些——单个数据block上可以存放更多的索引key嘛。
