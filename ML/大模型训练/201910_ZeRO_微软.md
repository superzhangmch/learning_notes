- 《ZeRO: Memory Optimizations Toward Training Trillion Parameter Models》 https://arxiv.org/pdf/1910.02054
- https://github.com/microsoft/deepspeed
- ZeRO 乃 deepspeed 背后的技术

ZeRO 分为两种
- ZeRO-DP：关注的是train时常驻显存（参数、梯度、优化器状态，统称为 model states）的优化。
  - DP=数据并行的
- ZeRO-R：关注的是非常驻显存（包括 激活/temporary buffer/显存碎片等，统称为 residual memory）的优化。
  - R=residual memory。
    - residual=剩余的, 残留的

----

### ZeRO-DP

ZeRO-DP 优化的是fp16+fp32 混合精度训练场景（该混合态训练见[here](https://github.com/superzhangmch/learning_notes/blob/main/ML/%E5%A4%A7%E6%A8%A1%E5%9E%8B%E8%AE%AD%E7%BB%83/%E6%B7%B7%E5%90%88%E7%B2%BE%E5%BA%A6%E8%AE%AD%E7%BB%83_fp32_fp16.md)）。

有三个 ZeRO-level（逐步把"fp32的优化器+参数、fp16的梯度、fp16的参数"分散到参与数据并行的节点上），逐渐更节约显存，下图是每个节点上的显存占用情况：

<img width="1986" height="824" alt="image" src="https://github.com/user-attachments/assets/1291711c-1571-4cfd-aa1d-b4bd271b8bf5" />

