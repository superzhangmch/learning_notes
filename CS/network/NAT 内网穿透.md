# NAT 内网穿透

两个client 如果处于不同的内网中，是不能进行直接连接的。但是有相应的技术来突破这一点。

### 1. UDP 打洞穿透NAT 限制
简单说就是借助以一个中级服务器。

client A 与 B 向服务器S发起请求，于是A 与 B 的外网的IP 与 PORT 就被S 所获知了。然后  S 可以把这些统统告诉 A 与 B. 然后 A 与 B 就可以互相往对方的外网 IP:PORT 发送 UDP 消息了。

注意A 与 B这时候互相对发，对方是未必能收到的，但是不用管。A 与 B 每个都稍有间隔的往外对发，直到收到对方消息，并搭上话为止【正常情况下，这个是终究能成功的，因为：当第一次 A->B时，可能B还没法接收，因为B处的NAT没法主动接收。但是如果在A->B已经发出，并在 B 处NAT 发生消息拒绝后，B->A 发了出去，那么 A 是能接收到消息的。仿佛B成功接收了一样。这时候 A->B  再发送一次，就能保证消息传到 B 了】。


### 2. TCP
这个日后补充。


### 【参考】
- http://en.wikipedia.org/wiki/UDP_hole_punching
- http://en.wikipedia.org/wiki/TCP_hole_punching
